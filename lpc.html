<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Damrauer Lab - LPC Overview</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./rstudio.html" rel="next">
<link href="./index.html" rel="prev">
<link href="./favicon_io/apple-touch-icon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lpc.html">Getting Started</a></li><li class="breadcrumb-item"><a href="./lpc.html">LPC Overview</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Damrauer Lab</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/mglev1n/damrauer-lab">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="http://github.com/mglev1n/damrauer-lab/issues/new">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Getting Started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lpc.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">LPC Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RStudio Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Useful Tools/Functions</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#links-and-resources" id="toc-links-and-resources" class="nav-link active" data-scroll-target="#links-and-resources">Links and Resources</a></li>
  <li><a href="#getting-started-e.g.-new-students" id="toc-getting-started-e.g.-new-students" class="nav-link" data-scroll-target="#getting-started-e.g.-new-students">Getting Started (e.g., new students)</a></li>
  <li><a href="#logging-into-the-lpc" id="toc-logging-into-the-lpc" class="nav-link" data-scroll-target="#logging-into-the-lpc">Logging into the LPC</a>
  <ul class="collapse">
  <li><a href="#logging-in-from-linuxmac-terminal" id="toc-logging-in-from-linuxmac-terminal" class="nav-link" data-scroll-target="#logging-in-from-linuxmac-terminal">Logging in from Linux/Mac Terminal:</a></li>
  <li><a href="#logging-in-from-macos" id="toc-logging-in-from-macos" class="nav-link" data-scroll-target="#logging-in-from-macos">Logging in from MacOS</a></li>
  <li><a href="#logging-in-from-windows" id="toc-logging-in-from-windows" class="nav-link" data-scroll-target="#logging-in-from-windows">Logging in from Windows</a></li>
  </ul></li>
  <li><a href="#navigating-the-lpc-from-a-command-line" id="toc-navigating-the-lpc-from-a-command-line" class="nav-link" data-scroll-target="#navigating-the-lpc-from-a-command-line">Navigating the LPC from a command line</a></li>
  <li><a href="#customizing-your-environment" id="toc-customizing-your-environment" class="nav-link" data-scroll-target="#customizing-your-environment">Customizing your environment</a></li>
  <li><a href="#using-queues" id="toc-using-queues" class="nav-link" data-scroll-target="#using-queues">Using queues</a></li>
  <li><a href="#submitting-jobs" id="toc-submitting-jobs" class="nav-link" data-scroll-target="#submitting-jobs">Submitting Jobs</a>
  <ul class="collapse">
  <li><a href="#sample-job-script" id="toc-sample-job-script" class="nav-link" data-scroll-target="#sample-job-script">Sample job script</a></li>
  </ul></li>
  <li><a href="#best-practices-miscellaneous-tips" id="toc-best-practices-miscellaneous-tips" class="nav-link" data-scroll-target="#best-practices-miscellaneous-tips">Best practices &amp; Miscellaneous tips</a></li>
  <li><a href="#troubleshooting" id="toc-troubleshooting" class="nav-link" data-scroll-target="#troubleshooting">Troubleshooting</a></li>
  <li><a href="#lpc-commands-cheat-sheet" id="toc-lpc-commands-cheat-sheet" class="nav-link" data-scroll-target="#lpc-commands-cheat-sheet">LPC Commands Cheat Sheet</a>
  <ul class="collapse">
  <li><a href="#lsf-job-scheduling-system-commands" id="toc-lsf-job-scheduling-system-commands" class="nav-link" data-scroll-target="#lsf-job-scheduling-system-commands">LSF (job scheduling system) commands</a></li>
  <li><a href="#pmacs-software-module-commands" id="toc-pmacs-software-module-commands" class="nav-link" data-scroll-target="#pmacs-software-module-commands">PMACS software module commands</a></li>
  <li><a href="#miscellaneous-commands" id="toc-miscellaneous-commands" class="nav-link" data-scroll-target="#miscellaneous-commands">Miscellaneous commands</a></li>
  </ul></li>
  <li><a href="#frequently-asked-questions" id="toc-frequently-asked-questions" class="nav-link" data-scroll-target="#frequently-asked-questions">Frequently Asked Questions</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/mglev1n/damrauer-lab/edit/master/docs/lpc.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/mglev1n/damrauer-lab/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lpc.html">Getting Started</a></li><li class="breadcrumb-item"><a href="./lpc.html">LPC Overview</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">LPC Overview</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The Damrauer Lab primarily uses the Penn <a href="https://www.med.upenn.edu/dart/computing.html">LPC</a> (Limited Performance Computing) environment for computing. This environment can be accessed from any computer on- or off-campus with the use of a VPN (virtual private network).</p>
<p>The overview below is adapted from the <a href="https://github.com/EpistasisLab/LPC">Moore lab</a> and <a href="https://github.com/EpistasisLab/LPC">Ritchie lab</a>.</p>
<section id="links-and-resources" class="level2">
<h2 class="anchored" data-anchor-id="links-and-resources">Links and Resources</h2>
<ul>
<li><a href="https://wiki.pmacs.upenn.edu/pub/LPC">PMACS Wiki - LPC</a></li>
<li><a href="https://wiki.pmacs.upenn.edu/pub/LSF_Basics">PMACS Wiki - LSF Basics</a></li>
<li><a href="https://wiki.pmacs.upenn.edu/pub/Batch_Computing">PMACS Wiki - Batch Computing</a></li>
</ul>
</section>
<section id="getting-started-e.g.-new-students" class="level2">
<h2 class="anchored" data-anchor-id="getting-started-e.g.-new-students">Getting Started (e.g., new students)</h2>
<ul>
<li><strong>Step 1: Get your PennKey and request LPC account access.</strong> If you don’t yet have a PennKey, please email <a href="medhelp@pennmedicine.upenn.edu">medhelp@pennmedicine.upenn.edu</a> to request one. Then, to create a user account, submit a ticket to the Systems queue at <a href="https://helpdesk.pmacs.upenn.edu/">https://helpdesk.pmacs.upenn.edu/</a>. You will be assigned an account username which will serve as the name of your home directory as well as be used to log onto the LPC.</li>
<li><strong>Step 2: Set up VPN for off campus LPC access</strong>. In order to connect on or off campus you will first need to connect to campus with a virtual private network (VPN).
<ul>
<li>First, make sure you enroll in <a href="https://wiki.pmacs.upenn.edu/pub/HSRDC_Getting_Started#Duo_Two-Factor_Authentication">DUO Two-factor authentication</a>. This is needed to access most online UPenn resources from off campus.</li>
<li>Next install the <a href="https://www.med.upenn.edu/dart/assets/user-content/documents/manually-install-and-setup-vpn-on-mac.pdf">Pulse Secure Software from DART</a>. Detailed instructions can be found <a href="https://www.isc.upenn.edu/sites/default/files/pulse_secure_vpn_cc.pdf">here</a>.</li>
</ul></li>
</ul>
<p>When each of these are complete, you should be able to log into the LPC using the instructions that follow. Note: You’ll need to log into the VPN prior to logging into LPC.</p>
</section>
<section id="logging-into-the-lpc" class="level2">
<h2 class="anchored" data-anchor-id="logging-into-the-lpc">Logging into the LPC</h2>
<p>To login to the LPC (and reach your home directory) you will need either a terminal program (i.e.&nbsp;command line) or (if preferred) a graphical user interface (GUI) program. These programs differ if you have Windows, Mac or Linux Machine. Please see the following link for your appropriate operating system and style of login: <a href="https://wiki.pmacs.upenn.edu/pub/LPC">https://wiki.pmacs.upenn.edu/pub/LPC</a> (Under ‘Login Software Installation’). A specific Windows example is provided later in this section. Once you have an appropriate program, you will use it to log on to a server (based on who you are affiliated with). This file server/host is a head node, from which you can navigate the LPC directories (including your home) and submit jobs.</p>
<p>The Damrauer Lab has its own server on LPC called <em>roubaix</em>, which can be used to run both interactive and batch jobs. To browse files on the LPC and to submit jobs, you will use the <code>scisub7</code> host.</p>
<ul>
<li><code>scisub7</code> (<code>scisub7.pmacs.upenn.edu</code>) is the submit host, and is open to anyone with VPN access (SSH only – i.e.&nbsp;a secure remote login protocol). Be aware that <code>scisub7</code> is a virtual host with limited computing power. It cannot be used to run intensive processes, but can be used to move files and submit jobs.</li>
</ul>
<section id="logging-in-from-linuxmac-terminal" class="level3">
<h3 class="anchored" data-anchor-id="logging-in-from-linuxmac-terminal">Logging in from Linux/Mac Terminal:</h3>
<p>SSH is a secure login protocol which enables access between two computers. This protocol is commonly available on Linux and Mac operating systems, and can be accessed using the terminal. To login to <code>scisub7</code>, open a terminal window and execute the following command:</p>
<ul>
<li><code>ssh username@scisub7.pmacs.upenn.edu</code></li>
</ul>
</section>
<section id="logging-in-from-macos" class="level3">
<h3 class="anchored" data-anchor-id="logging-in-from-macos">Logging in from MacOS</h3>
<p>As mentioned in the above section, while MacOS built-in terminal is sufficient for submitting jobs, the Cyberduck GUI can be helpful for navigating the file structure.</p>
<section id="using-cyberduck" class="level4">
<h4 class="anchored" data-anchor-id="using-cyberduck">Using Cyberduck</h4>
<ul>
<li><a href="https://cyberduck.io/download/">Download</a> Cyberduck</li>
<li>Ensure you are connected to VPN via PulseSecure</li>
<li>Open Cyberduck</li>
<li>Select <code>Open Connection</code> on the top left</li>
<li>In this window, select <code>SFTP (SSH File Transfer Protocol)</code></li>
<li>Enter <code>servername.pmacs.upenn.edu</code> under <code>'Server'</code></li>
<li>Confirm <code>'Port' = 22</code></li>
<li>Enter your PMACS username and password</li>
<li>Click <code>Connect</code>, and a GUI will open up allowing you to view the directory on the LPC (it should open you up to your home directory the first time logging on).</li>
</ul>
</section>
</section>
<section id="logging-in-from-windows" class="level3">
<h3 class="anchored" data-anchor-id="logging-in-from-windows">Logging in from Windows</h3>
<p>It is useful to install both the terminal and GUI software below. The terminal is best for submitting jobs and the GUI is best for navigating and managing the file hierarchy and copying files to and from the LPC. Modern Windows operating systems may have SSH natively enabled from the command line - first try following the instructions for Linux/Mac above.</p>
<ul>
<li><strong>Windows (Terminal): <a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/">PuTTY</a></strong></li>
<li><strong>Windows (GUI): <a href="https://winscp.net/eng/download.php">WinSCP</a></strong></li>
<li><strong>Windows (All-in-One): <a href="https://wiki.pmacs.upenn.edu/public/MobaXterm">MobaXterm</a></strong></li>
</ul>
<p><strong>Logging in with PuTTY:</strong> - Ensure you are connected to VPN via PulseSecure. - Open the putty .exe file - In the ‘Session’ window, enter <code>scisub7.pmacs.upenn.edu</code> under ‘Host Name’ - Confirm <code>'Port' = 22</code> and <code>'Connection type' = SSH</code> - [For convenience] In the ‘Connection/Data’ window put the LPC username you were assigned into ‘auto-login username’ - [For convenience] Go back to the ‘Session’ window and type in any session ‘name’ into ‘Saved Sessions’. E.g. ‘LPC_damrauer’ - [For convenience] Click save, and this information will be available to be loaded your next time opening Putty - Make sure you session is loaded and click ‘Open’ at bottom of the window - A terminal will open up requesting your username (if you didn’t save it in step 5). - Lastly you will be prompted for your password.</p>
<p><strong>Logging in with WinSCP:</strong> - Ensure you are connected to VPN via PulseSecure. - Open WinSCP software - In the ‘Session’ window, enter <code>servername.pmacs.upenn.edu</code> under ‘Host Name’ - Confirm <code>'Port' = 22</code>, <code>'Connection type' = SSH</code>, and <code>'File protocol' = SFTP</code> - Enter your username and password where indicated - [For convenience] Click Save and give your session any name for future use. - Click ‘Login’ to connect, and a GUI will open up allowing you to view both your local PC’s directory as well as the directory on the LPC (it should open you up to your home directory the first time logging on).</p>
<p>Note that it is also possible to configure WinSCP to automatically open a putty terminal upon connection.</p>
<p><strong>Logging in with MobaXterm:</strong> - This is the PMACS preferred method to interact with LPC. - MobaXterm can be downloaded from <a href="https://mobaxterm.mobatek.net/">https://mobaxterm.mobatek.net/</a>, see <a href="https://mobaxterm.mobatek.net/documentation.html#2">https://mobaxterm.mobatek.net/documentation.html#2</a> for additional documentation - Please consult the instructions on the PMACS wiki for more details regardig usage and installation</p>
</section>
</section>
<section id="navigating-the-lpc-from-a-command-line" class="level2">
<h2 class="anchored" data-anchor-id="navigating-the-lpc-from-a-command-line">Navigating the LPC from a command line</h2>
<p>Linux commands are needed to navigate the LPC from a terminal (e.g.&nbsp;PuTTY). See the following link for an overview of basic Linux commands:</p>
<p><a href="https://wiki.pmacs.upenn.edu/pub/Linux_Basics">https://wiki.pmacs.upenn.edu/pub/Linux_Basics</a></p>
<p>Some of the most commonly used basic commands include:</p>
<ul>
<li><code>ls</code> (lists contents of current directory)</li>
<li><code>ls -a</code> (lists contents of current directory including hidden files)</li>
<li><code>cd somedirectory</code> (move from current directory to ‘somedirectory’)</li>
<li><code>cd ..</code> (move back one level in the folder hierarchy towards the root folder)</li>
<li><code>mkdir somedirectory</code> (make a new directory called <code>somedirectory</code>)</li>
<li><code>head myfile.txt</code> (show the beginning of a file)</li>
</ul>
<p>A great tutorial on how to effectively use a Unix command line is available at [https://missing.csail.mit.edu/](https://missing.csail.mit.edu/.</p>
</section>
<section id="customizing-your-environment" class="level2">
<h2 class="anchored" data-anchor-id="customizing-your-environment">Customizing your environment</h2>
<p>Depending on what you want to run on the LPC, you may need to install various applications, packages, programming language versions, etc. To avoid confusion and keep things centralized, PMACS installs and manages common applications in a shared central directory that are available to all the hosts in our cluster. The LPC terms these environmental elements as ‘modules’. Modules can be loaded or unloaded to be made available in your run environment. This means that these modules will be available if you were to run a program locally or when you submit a job from a given host. Terminal commands for working with modules are available at this link:</p>
<p><a href="https://wiki.pmacs.upenn.edu/pub/LPC#Modules">https://wiki.pmacs.upenn.edu/pub/LPC#Modules</a></p>
<p>Alternatively if some application or package is not available or (for some reason) can’t be installed by PMACS under modules, you can install such packages or applications in your home directory. Be advised that PMACS provides very limited (if any) support when loading or using such installations on your own.</p>
</section>
<section id="using-queues" class="level2">
<h2 class="anchored" data-anchor-id="using-queues">Using queues</h2>
<p>The first thing to understand before trying to schedule jobs are ‘queues’. At face value, a queue represents a set of pending jobs (i.e.&nbsp;a ‘container’ for jobs). On the LPC different queues are available to different user groups allowing them to run their jobs. You must be associated with, and have permission from, a specific user group in order to submit jobs to their associated queue. Each queue is set up by PMACS with their own set of rules, defaults, and access to specific execute hosts (i.e.&nbsp;the servers comprised of computing cores where individual jobs are run).</p>
<p>There are a few general queue types:</p>
<ul>
<li><code>normal</code>: For most non-interactive jobs. Typical non-interactive jobs can be accessed submitted to the <code>damrauer_normal</code> queue.</li>
<li><code>long</code>: For long running jobs (more than 24 hr).</li>
<li><code>interactive</code>: For jobs that are run interactively. Interactive jobs can be submitted to the <code>damrauer_interactive</code> queue.</li>
</ul>
<p>More information on queues in general is available here:</p>
<p><a href="https://wiki.pmacs.upenn.edu/pub/LSF_Basics">https://wiki.pmacs.upenn.edu/pub/LSF_Basics</a></p>
</section>
<section id="submitting-jobs" class="level2">
<h2 class="anchored" data-anchor-id="submitting-jobs">Submitting Jobs</h2>
<p>High performance parallel computing codes generally run in “batch” mode. Batch jobs are controlled by scripts written by the user and submitted to a batch system that manages the compute resource and schedules the job to run based on a set of policies. We use the term “job” to refer to a “batch job”.</p>
<p>Computing ‘jobs’ can be submitted individually from the command line, or you can write and run an executable script to submit multiple jobs to a queue simultaneously.</p>
<p><strong>IBM’s LSF documentation is available here:</strong> <a href="https://www.ibm.com/support/knowledgecenter/en/SSWRJV_10.1.0/lsf_welcome/lsf_welcome.html">https://www.ibm.com/support/knowledgecenter/en/SSWRJV_10.1.0/lsf_welcome/lsf_welcome.html</a></p>
<p>Additionally, if you are planning to submit a large number of resource intensive jobs, it is recommended to discuss first with other lab members to coordinate resource usage.</p>
<section id="sample-job-script" class="level3">
<h3 class="anchored" data-anchor-id="sample-job-script">Sample job script</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#BSUB -J myjobname</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#BSUB -o outputfile.%J.out</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#BSUB -e errorfile.%J.err</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#BSUB -q damrauer_normal</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#BSUB -M 10000</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="ex">module</span> add python/3.7</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /project/damrauer_shared/users/myhomedirectory</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="ex">python3.7</span> script.py <span class="at">-parA</span> 0 <span class="at">-parB</span> value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Assuming this is saved to a file named <code>script.sh</code> or <code>script.bsub</code>, you can submit the job by running:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> bsub <span class="op">&lt;</span> script.sh</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> bsub <span class="op">&lt;</span> script.bsub</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="best-practices-miscellaneous-tips" class="level2">
<h2 class="anchored" data-anchor-id="best-practices-miscellaneous-tips">Best practices &amp; Miscellaneous tips</h2>
<p>To avoid accidental deletion or overwriting of files it is recommended that you put these aliases in your <code>.bashrc</code>:</p>
<ul>
<li><code>alias rm='rm -i'</code></li>
<li><code>alias mv='mv -i'</code></li>
<li><code>alias cp='cp -i'</code></li>
</ul>
<p>Each of these will prompt linux to ask you confirmation for the corresponding action.</p>
<p>To avoid filling up our disk space, plan to direct large job outputs and easily generated intermediate files to <code>/project/scratch/</code>. You can check the disk you are working on by using <code>realpath .</code> or <code>pwd -P</code> and the amount of space left by using <code>df -h</code>. Note that scratch space is not backed up, so you should not use it for long term storage of data that is near and dear to you!!!</p>
</section>
<section id="troubleshooting" class="level2">
<h2 class="anchored" data-anchor-id="troubleshooting">Troubleshooting</h2>
<p>If you have any question, you can first discuss with other lab members, or submit a ticket at <a href="https://helpdesk.pmacs.upenn.edu/">https://helpdesk.pmacs.upenn.edu/</a></p>
<p>It’s also a good idea to provide your ip address when asking a question regarding connection: http://www.med.upenn.edu/myip.</p>
</section>
<section id="lpc-commands-cheat-sheet" class="level2">
<h2 class="anchored" data-anchor-id="lpc-commands-cheat-sheet">LPC Commands Cheat Sheet</h2>
<section id="lsf-job-scheduling-system-commands" class="level3">
<h3 class="anchored" data-anchor-id="lsf-job-scheduling-system-commands">LSF (job scheduling system) commands</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>bjobs</code></td>
<td>Show unfinished jobs</td>
</tr>
<tr class="even">
<td><code>bjobs -sum</code></td>
<td>Summarize active jobs</td>
</tr>
<tr class="odd">
<td><code>bjobs -u ryanurb</code></td>
<td>Show jobs for user <code>ryanurb</code></td>
</tr>
<tr class="even">
<td><code>bkill 12345</code></td>
<td>Kill job with ID <code>12345</code></td>
</tr>
<tr class="odd">
<td><code>bkill 0</code></td>
<td>Kill all jobs that belong to you</td>
</tr>
<tr class="even">
<td><code>bhosts doi_exe</code></td>
<td>Show server hosts</td>
</tr>
<tr class="odd">
<td><code>bhosts</code></td>
<td>Show all hosts</td>
</tr>
<tr class="even">
<td><code>bswitch</code></td>
<td>Switch a job to a different queue</td>
</tr>
</tbody>
</table>
<p>Some other LSF commands can be found <a href="https://www.med.upenn.edu/hpc/assets/user-content/documents/lsf-quick-reference_user_commands.pdf">here</a>.</p>
</section>
<section id="pmacs-software-module-commands" class="level3">
<h3 class="anchored" data-anchor-id="pmacs-software-module-commands">PMACS software module commands</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 40%">
<col style="width: 59%">
</colgroup>
<thead>
<tr class="header">
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>module list</code></td>
<td>List loaded modules</td>
</tr>
<tr class="even">
<td><code>module avail</code></td>
<td>List all available modules</td>
</tr>
<tr class="odd">
<td><code>module avail python</code></td>
<td>List available python modules</td>
</tr>
<tr class="even">
<td><code>module load python/3.7</code></td>
<td>Loads the module named <code>python/3.7</code></td>
</tr>
<tr class="odd">
<td><code>module unload python/2.7.10</code></td>
<td>Unloads the module named <code>python/2.7.10</code></td>
</tr>
<tr class="even">
<td><code>module switch gcc/4.9.4 gcc/6.2.0</code></td>
<td>Swap out module <code>gcc/4.9.4</code> for <code>gcc/6.2.0</code> (useful for changing software versions)</td>
</tr>
</tbody>
</table>
</section>
<section id="miscellaneous-commands" class="level3">
<h3 class="anchored" data-anchor-id="miscellaneous-commands">Miscellaneous commands</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>df -h</code></td>
<td>Get current disk usage and total disk capacity</td>
</tr>
<tr class="even">
<td><code>du -hs</code></td>
<td>Get size of current directory</td>
</tr>
</tbody>
</table>
<p><em>Please note that at the request of PMACS, <code>du</code> commands should be used sparingly to avoid catastrophic burden on the filesystem</em></p>
</section>
</section>
<section id="frequently-asked-questions" class="level2">
<h2 class="anchored" data-anchor-id="frequently-asked-questions">Frequently Asked Questions</h2>
<ul>
<li><p><strong>My jobs have been stuck in the queue with <code>PENDING</code> status forever and I need them to start running!</strong></p>
<p>Unfortunately, if many other people are also running jobs, you may just have to wait your turn. You can check how many jobs are waiting in our queues using the command <code>bjobs -u "all" | grep "damrauer"</code></p>
<p>However, even if there are many jobs waiting, there are some ways that you might be able to reduce how long your job sits in the queue. Sometime people will request much more memory, walltime, and/or nodes than the job actually needs to run. Your job cannot start until the resources you request are available, so the more you request, potentially the longer it could take to start. If you have ran a similar job before, check the resource usage to see the max memory and time it took to run. You may be able to reduce your current resource requests based on what you find. Also make sure that the program or function you are running is actually able to take advantage of multiple nodes. For example, requesting 16 nodes to run an Rscript that you haven’t parallized will reserve 15 extra nodes for nothing.</p>
<p>Remember if you are running an analysis that requires a lot of resources, it’s a good idea to post in #support-lpc with a summary of your compute needs and time it will take to complete so that all lab members can know and plan accordingly and make sure there are no deadline conflicts.</p></li>
<li><p><strong>I calculated how long my jobs will take to run on LPC and it is months of compute time!</strong></p>
<p>You may ask Scott about possibly moving your analysis, or a portion or your analysis, to DNAnexus or the HPC (High Performance Computing cluster). If you want to use these resources to run an analysis, generally you will need to do some cost scoping to have a rough idea of the total compute costs before you submit.</p></li>
<li><p><strong>How can I run the same job on a bunch of different input files or with a bunch of different parameters without creating a <code>bsub</code> script for each one?</strong></p>
<p>This is a perfect scenario for subitting an array job! The array index is saved into a variable called <code>LSB_JOBINDEX</code>. Say you want to run <code>bcftools norm</code> for 3 chromosomes with in files named <code>chr1.vcf</code>, <code>chr2.vcf</code>, and <code>chrX.vcf</code>. You could make the following changes to your script</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#BSUB -J jobname[1-3]</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#other BSUB options as normal</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#job commands</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="va">myArray</span><span class="op">=</span><span class="va">(</span><span class="st">"1"</span> <span class="st">"2"</span> <span class="st">"X"</span><span class="va">)</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="va">myValue</span><span class="op">=</span><span class="st">"</span><span class="va">${myArray</span><span class="op">[</span><span class="va">${LSB_JOBINDEX}</span> - 1<span class="op">]</span><span class="va">}</span><span class="st">"</span>  <span class="co"># to access each element in the array</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="ex">bcftools</span> norm <span class="at">-m</span> <span class="at">-any</span> /path/to/file/chr<span class="va">${myValue}</span>.vcf <span class="at">-Ou</span> <span class="kw">|</span> <span class="ex">bcftools</span> view <span class="at">-Q</span> 0.05:minor <span class="at">-c</span> 20:minor <span class="at">-Ov</span> <span class="op">&gt;</span> chr<span class="va">${myValue}</span><span class="st">"_norm.vcf"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If all of your chromosome file names contain integers, you could even simplify this to just using the <code>LSB_JOBINDEX</code> variable directly like</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#BSUB -J jobname[1-22]</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#other BSUB options as normal</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#job commands</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="ex">bcftools</span> norm <span class="at">-m</span> <span class="at">-any</span> /path/to/file/chr<span class="va">${LSB_JOBINDEX}</span>.vcf <span class="at">-Ou</span> <span class="kw">|</span> <span class="ex">bcftools</span> view <span class="at">-Q</span> 0.05:minor <span class="at">-c</span> 20:minor <span class="at">-Ov</span> <span class="op">&gt;</span> chr<span class="va">${LSB_JOBINDEX}</span><span class="st">"_norm.vcf"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Another tip is that you can also use a command to get the array. For example if you have a list of chr files called <code>chr1.vcf</code> etc., you can do something like</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#BSUB -J jobname[1-3]</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#other BSUB options as normal</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#job commands</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="va">myArray</span><span class="op">=</span><span class="va">(</span><span class="kw">`</span><span class="fu">ls</span> <span class="at">-1</span> /path/to/input/files/chr<span class="pp">*</span>vcf<span class="kw">`</span><span class="va">)</span> <span class="co"># you can chain sed, cut, etc. commands here using pipes if you want to format the values in the array!</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="va">myValue</span><span class="op">=</span><span class="st">"</span><span class="va">${myArray</span><span class="op">[</span><span class="va">${LSB_JOBINDEX}</span> - 1<span class="op">]</span><span class="va">}</span><span class="st">"</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="ex">bcftools</span> norm <span class="at">-m</span> <span class="at">-any</span> <span class="va">${myValue}</span> <span class="at">-Ou</span> <span class="kw">|</span> <span class="ex">bcftools</span> view <span class="at">-Q</span> 0.05:minor <span class="at">-c</span> 20:minor <span class="at">-Ov</span> <span class="op">&gt;</span> <span class="va">${myValue}</span><span class="st">".norm.vcf"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p><strong>My job finished but it didn’t output anything. What happened?</strong></p>
<p>First, make sure you have enabled the options to get a resource summary emailed to you and to output the <code>.err</code> file. Commonly a few things could have happened.</p>
<ol type="1">
<li>The job produced an error of some sort and you will need to fix your script.</li>
<li>The job ran out of walltime or memory. You can look at the resource usage e-mail to see if this happened.</li>
<li>The job ran fine, but there was no disk space to write the output file. If you didn’t get any errors and the resource usage looks fine, you can check which disk you were writing the output file to using <code>pwd -P</code> and how much space is left on the disk using <code>df -h</code>. If there is limited space, you may need to either temporarily direct your output to a <code>scratch</code> disk or work with other lab members to move files around.</li>
</ol></li>
<li><p><strong>I can’t get my R package to install.</strong></p>
<p>There are a number of reasons why this may happen. If you get an error such as <code>ModuleCmd_Load.c(208):ERROR:105: Unable to locate a modulefile for []</code> the issue may be as simple as quitting the R session, loading a module for the library that you are getting an error about, and restarting R. <code>gcc</code>, <code>boost</code>, <code>mpfr</code>, and <code>mpc</code> are common offenders.</p></li>
<li><p><strong>LPC is running very slowly!</strong></p>
<p>First, you might want to check with others in the lab to see if they are experiencing similar issues and it’s not just a glitch or momentary network problem. You might also want to have a look at the current running processes using <code>top</code>. If you or someone else is running a resource intensive process from the log in node, it might be best to kill the process and start an <code>ibash</code> session.</p></li>
<li><p><strong>I’m getting an error or have a problem that wasn’t mentioned here and I don’t know what it means or how to fix it.</strong></p>
<p>Well the first thing we usually want to do in this case is the classic Google/StackOverflow combination. <em>Most</em> of the time, you probably haven’t broken something beyond repair and instead just found a common bug that has already been solved by many other people on the internet.</p>
<p>If Google doesn’t work, you may want to search for keywords from your error in the lab’s Slack to see if any other lab members have come across the problem before. If you can’t find it, you can discuss with other lab members. It is great practice to post the full error message along with the line of code or command that you were running. If you have a problem with a script another lab member wrote for you, it’s also great to provide a small, reproducible example that they can run and try to troubleshoot.</p>
<p>Lastly, if you are having an issue with something like installing a software package or a bizarre problem with a job submission and have exhausted all the other options, you can try submitting a ticket to DART at <a href="helpdesk.pmacs.upenn.edu">helpdesk.pmacs.upenn.edu</a>. Again they will best be able to help you if you give them all the relevant detail mentioned above.</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/mglev1n\.github\.io\/damrauer-lab\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Overview">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Overview</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./rstudio.html" class="pagination-link" aria-label="RStudio Overview">
        <span class="nav-page-text">RStudio Overview</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/mglev1n/damrauer-lab/edit/master/docs/lpc.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/mglev1n/damrauer-lab/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>